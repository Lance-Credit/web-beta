<template>
    <div>
        <Auth-BaseAuth>
            <template #auth-illustration>
                <div>
                    <div v-if="!communityCodeFilled" class="pb-[72px] text-center">
                        <div class="mb-14">
                            <div class="mb-[18.36px] pl-[15px]">
                                <img :src="illustrations[activeIllustration].img" alt="">
                            </div>
                            <p class="mb-6 text-[#232D44] text-4xl leading-[32px] tracking-[-0.36px]">
                                {{ illustrations[activeIllustration].title }}
                            </p>
                            <p class="text-lance-black-60 text-lg leading-[26px] tracking-[0.18px] max-w-[377px] mx-auto">
                                {{ illustrations[activeIllustration].bodyText }}
                            </p>
                        </div>
                        <div class="flex gap-2 items-center justify-center">
                            <SlideIndicator v-for="(illustration, key) in illustrations" :key="key" :active="key == activeIllustration" default-color="rgba(10,79,77,0.20)" active-color="#0A4F4D" />
                        </div>
                    </div>
    
                    <div v-else class="rounded-b-[80px] w-ful bg-[url('/assets/img/community-code-1000007199.svg')] bg-cover h-[377px]"></div>
                </div>
            </template>
            <template #auth-content>
                <div class="h-full grow flex">
                    <div v-if="!signUpSuccess" class="w-full">
                        <div v-if="!communityCodeFilled" class="flex flex-col h-full">
                            <div class="px-6 sm:px-0 mb-8 sm:mb-0">
                                <p class="mt-[37.61px] sm:mt-0 mb-1 text-lance-black font-aventa text-[24px] leading-[32px] tracking-[-0.24px]">
                                    Hey there!
                                </p>
                                <p class="mb-6 text-lance-black-60 text-sm sm:text-base leading-6">
                                    Welcome to Lance üëãüèæ
                                </p>
                            </div>
                            <div class="bg-white pt-10 sm:pt-0 px-6 sm:px-0 pb-[110px] sm:pb-0 rounded-t-3xl h-full">
                                <!-- <style>

                                </style> -->
                                <p class="mb-8 sm:mb-4 text-[rgba(4,17,17,0.80)] text-sm sm:text-base leading-[18px] sm:leading-6">
                                    To begin, we require your community code,
                                    <span class="text-[rgba(4,17,17,0.80)] font-semibold">a 6-digit access code</span>
                                    that grants you unrestricted entry to our platform.
                                </p>
                                <div class="mb-2">
                                    <Form-TextInput placeholder="Enter Community Code" label="Community Code" v-model="signupForm.communityCode[0].value" v-bind="signupForm.communityCode[1].value" :error="signupFormErrors.communityCode" />
                                </div>
                                <NuxtLink to="https://tally.so/r/w2KLJL" target="_blank" class="flex mb-4 sm:mb-8 text-lance-green text-sm sm:text-base leading-6">
                                    I do not have a community code
                                </NuxtLink>
    
                                <Form-ErrorNotification v-if="communityCodeErrorResponse" :message="communityCodeErrorResponse" />
    
                                <button @click="submitCommunityCode" class="mb-4 sm:mb-6 btn w-full btn-primary" :class="{'loading' : submittingCommunityCode}" :disabled="!signupFormValues.communityCode || submittingCommunityCode">
                                    <span v-show="!submittingCommunityCode">Continue</span>
                                    <Loader-Basic v-show="submittingCommunityCode" bg="#FFF" fg="#C3E48E" />
                                </button>
                                <NuxtLink to="/auth/login" class="flex gap-2 justiffy-start sm:justify-center text-lance-black-60 text-sm sm:text-base leading-6">
                                    Already have an account?<span class="text-lance-green font-medium">Login</span>
                                </NuxtLink>
                            </div>
                        </div>
        
                        <div v-else>
                            <div class="px-6 sm:px-0 mb-8 sm:mb-0">
                                <p class="mt-[37.61px] sm:mt-0 mb-2 text-lance-black font-aventa text-[24px] leading-[32px] tracking-[-0.24px]">
                                    Create your account
                                </p>
                                <p class="mb-6 text-lance-black-60 text-sm sm:text-base leading-6">
                                    Let‚Äôs get you started, Please provide the info below
                                </p>
                            </div>
                            <div class="bg-white pt-10 sm:pt-0 px-6 sm:px-0 pb-[110px] sm:pb-0 rounded-t-3xl h-full">
                                <div class="mb-8">
                                    <Form-TextInput class="mb-4" placeholder="First Name" label="First Name" v-model="signupForm.firstName[0].value" v-bind="signupForm.firstName[1].value" :error="signupFormErrors.firstName" />
                                    <Form-TextInput class="mb-4" placeholder="Last Name" label="Last Name" v-model="signupForm.lastName[0].value" v-bind="signupForm.lastName[1].value" :error="signupFormErrors.lastName" />
                                    <Form-EmailInput class="mb-4" placeholder="Email Address" label="Email Address" v-model="signupForm.email[0].value" v-bind="signupForm.email[1].value" :error="signupFormErrors.email" />
                                    <Form-TextInput class="mb-4" placeholder="090*****990" label="Phone Number" v-model="signupForm.phoneNumber[0].value" v-bind="signupForm.phoneNumber[1].value" :error="signupFormErrors.phoneNumber" />
                                    <Form-PasswordInput class="mb-4" placeholder="Enter Password" label="Enter Password" v-model="signupForm.password[0].value" v-bind="signupForm.password[1].value" :error="signupFormErrors.password" />
                                    <Form-PasswordRuleGuide :password="signupFormValues.password"/>
                                </div>
    
                                <Form-ErrorNotification v-if="signupErrorResponse" :message="signupErrorResponse" />
    
                                <button @click="submitSignUpForm" class="mb-6 btn w-full btn-primary" :class="{'loading' : submittingSignupForm}" :disabled="!signupFormFilled || submittingSignupForm">
                                    <span v-show="!submittingSignupForm">Continue</span>
                                    <Loader-Basic v-show="submittingSignupForm" bg="#FFF" fg="#C3E48E" />
                                </button>
                                <NuxtLink to="/auth/login" class="flex gap-2 justify-start sm:justify-center text-lance-black-60 text-sm sm:text-base leading-6">
                                    Already have an account?<span class="text-lance-green font-medium">Login</span>
                                </NuxtLink>
                            </div>
                        </div>
                    </div>
                    <div v-else class="flex flex-col">
                        <div v-if="emailVerified">
                            <div class="px-6 sm:px-0 mb-8 sm:mb-0">
                                <p class="mt-[37.61px] sm:mt-0 mb-2 text-lance-black font-aventa text-[24px] leading-[32px] tracking-[-0.24px]">
                                    Verify your phone number
                                </p>
                                <p class="mb-6 text-lance-black-60 text-sm sm:text-base leading-6">
                                    <span class="sm:hidden">
                                        Let‚Äôs get you started, Please provide the info below
                                    </span>
                                    <span class="hidden sm:block">
                                        Input the 6-digit verification code we sent to this phone number <span class="font-semibold">{{ formattedPhoneNumber }}</span> to activate your account.
                                    </span>
                                </p>
                            </div>
                            <div class="bg-white pt-10 sm:pt-0 px-6 sm:px-0 pb-[110px] sm:pb-0 rounded-t-3xl h-full">
                                <p class="mb-8 text-lance-black-60 text-sm leading-[18px] sm:hidden">
                                    Input the 6-digit verification code we sent to this phone number <span class="font-semibold">{{ formattedPhoneNumber }}</span> to activate your account.
                                </p>
                                <div class="mb-6">
                                    <Form-TextInput placeholder="Verification Code" label="Verification Code" v-model="signupForm.phoneVerificationCode[0].value" v-bind="signupForm.phoneVerificationCode[1].value" :error="signupFormErrors.phoneVerificationCode" />
                                </div>
    
                                <Form-ErrorNotification v-if="phoneVerificationCodeErrorResponse" :message="phoneVerificationCodeErrorResponse" />
    
                                <button
                                    @click="submitPhoneVerificationCode" class="mb-6 btn w-full btn-primary" :class="{'loading' : submittingPhoneVerificationCode}"
                                    :disabled="!(signupFormValues.phoneVerificationCode && !signupFormErrors.phoneVerificationCode) || submittingPhoneVerificationCode"
                                >
                                    <span v-show="!submittingPhoneVerificationCode">Continue</span>
                                    <Loader-Basic v-show="submittingPhoneVerificationCode" bg="#FFF" fg="#C3E48E" />
                                </button>
                                <p v-show="showResendPhoneVerificationCode" class="flex gap-2 justify-center text-lance-black-60">
                                    Didn‚Äôt get the code?<span @click="resendPhoneVerificationCode" class="text-lance-green font-medium cursor-pointer">Resend code</span>
                                </p>
                            </div>
                        </div>

                        <div v-else class="h-full flex flex-col">
                            <div class="px-6 sm:px-0 mb-8 sm:mb-0">
                                <p class="mt-[37.61px] sm:mt-0 mb-2 text-lance-black font-aventa text-[24px] leading-[32px] tracking-[-0.24px]">
                                    Verify your email address
                                </p>
                                <p class="mb-6 text-lance-black-60 text-sm sm:text-base leading-6">
                                    <span class="sm:hidden">
                                        Let‚Äôs get you started, Please provide the info below
                                    </span>
                                    <span class="hidden sm:block">
                                        Input the 6-digit verification code we sent to this email address <span class="font-semibold">{{ signupFormValues.email }}</span> to activate your account.
                                    </span>
                                </p>
                            </div>
                            <div class="bg-white pt-10 sm:pt-0 px-6 sm:px-0 pb-[110px] sm:pb-0 rounded-t-3xl h-full">
                                <p class="mb-8 text-lance-black-60 text-sm leading-[18px] sm:hidden">
                                    Input the 6-digit verification code we sent to this email address <span class="font-semibold">{{ signupFormValues.email }}</span> to activate your account.
                                </p>
                                <div class="mb-6">
                                    <Form-TextInput placeholder="Verification Code" label="Verification Code" v-model="signupForm.emailVerificationCode[0].value" v-bind="signupForm.emailVerificationCode[1].value" :error="signupFormErrors.emailVerificationCode" />
                                </div>
    
                                <Form-ErrorNotification v-if="emailVerificationCodeErrorResponse" :message="emailVerificationCodeErrorResponse" />
    
                                <button
                                    @click="submitEmailVerificationCode" class="mb-6 btn w-full btn-primary" :class="{'loading' : submittingEmailVerificationCode}"
                                    :disabled="!(signupFormValues.emailVerificationCode && !signupFormErrors.emailVerificationCode) || submittingEmailVerificationCode">
                                    <span v-show="!submittingEmailVerificationCode">Continue</span>
                                    <Loader-Basic v-show="submittingEmailVerificationCode" bg="#FFF" fg="#C3E48E" />
                                </button>
                                <p v-show="showResendEmailVerificationCode" class="flex gap-2 justify-center text-lance-black-60 text-sm sm:text-base leading-6">
                                    Didn‚Äôt get the code?<span @click="resendEmailVerificationCode" class="text-lance-green font-medium cursor-pointer">Resend code</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
        </Auth-BaseAuth>
        <Auth-Modal
            v-if="verificationCodeSubmitted"
            title="Welcome to Lance"
            :text="referrerText"
            button-text="Proceed to your dashboard"
            button-link="/dashboard"
        >
            <svg width="158" height="193" viewBox="0 0 158 193" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M0.355865 136.718L16.0847 99.7148L25.7465 103.836L16.8685 124.723L16.7675 124.77C14.9585 125.613 13.4223 126.949 12.3349 128.624L10.2143 131.891C8.12656 135.108 4.47834 136.956 0.655106 136.736L0.355865 136.718ZM131.718 192.23H91.57V181.709H114.231L114.314 181.785C115.798 183.121 117.626 184.014 119.591 184.36L123.423 185.035C127.194 185.699 130.321 188.337 131.616 191.947L131.718 192.23Z" fill="#0A4F4D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M16.6527 124.525L16.6603 124.522L25.3919 103.979L16.227 100.07L0.754776 136.47C4.44027 136.652 7.9729 134.848 9.98714 131.744L12.1078 128.477C13.2243 126.756 14.7962 125.39 16.6527 124.525ZM10.4403 132.039C8.41907 135.152 4.94747 137.023 1.2663 137.023C1.0578 137.023 0.84877 137.017 0.639725 137.006L0.339935 136.988C0.252426 136.983 0.172485 136.936 0.126022 136.861C0.0795746 136.786 0.0725555 136.693 0.107117 136.612L15.836 99.6089C15.8943 99.4714 16.0536 99.4076 16.1903 99.466L25.8521 103.587C25.918 103.615 25.9704 103.669 25.9969 103.735C26.0239 103.801 26.0228 103.876 25.9947 103.942L17.1167 124.829C17.0908 124.891 17.0427 124.94 16.9822 124.968L16.8806 125.016C15.1159 125.838 13.6219 127.137 12.561 128.772L10.4403 132.039ZM91.8399 191.959H131.333C130.057 188.489 127.015 185.941 123.375 185.301L119.544 184.626C117.527 184.271 115.656 183.358 114.133 181.985L91.8399 181.98V191.959ZM131.718 192.5H91.5698C91.4207 192.5 91.2997 192.379 91.2997 192.229V181.709C91.2997 181.56 91.4207 181.438 91.5698 181.438H114.231C114.298 181.438 114.362 181.463 114.412 181.508L114.495 181.583C115.942 182.887 117.72 183.755 119.637 184.093L123.469 184.767C127.327 185.447 130.545 188.162 131.87 191.855L131.971 192.138C132.001 192.221 131.989 192.313 131.938 192.385C131.888 192.457 131.805 192.5 131.718 192.5Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M27.5093 130.44L16.8681 124.722L25.7462 103.835L38.2292 110.812C43.2143 113.599 45.2993 119.703 43.0626 124.964C40.4914 131.013 33.2927 133.547 27.5093 130.44ZM115.313 169.661L114.231 181.708H91.5698L93.0871 167.47C93.6931 161.784 98.4827 157.47 104.191 157.47C110.754 157.47 115.902 163.113 115.313 169.661Z" fill="#D27D41"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M38.0971 111.049L25.8766 104.218L17.213 124.6L27.6364 130.202C30.3264 131.647 33.5209 131.894 36.4005 130.88C39.2801 129.867 41.6179 127.672 42.8138 124.858C45.0014 119.711 42.9737 113.775 38.0971 111.049ZM36.5798 131.391C35.352 131.823 34.0708 132.037 32.7922 132.037C30.9222 132.037 29.0581 131.58 27.3815 130.678L16.7398 124.961C16.6167 124.894 16.5643 124.745 16.6194 124.616L25.4974 103.73C25.5271 103.659 25.586 103.604 25.6584 103.579C25.7308 103.554 25.8107 103.562 25.8771 103.599L38.3602 110.576C43.4787 113.437 45.6069 119.668 43.3107 125.07C42.0554 128.023 39.602 130.327 36.5798 131.391ZM91.8698 181.438H113.984L115.044 169.636C115.318 166.591 114.294 163.549 112.234 161.293C110.175 159.035 107.243 157.741 104.191 157.741C98.6066 157.741 93.9483 161.936 93.3552 167.498L91.8698 181.438ZM114.231 181.979H91.5694C91.4927 181.979 91.4198 181.947 91.3685 181.889C91.3172 181.833 91.2923 181.756 91.3004 181.68L92.8183 167.441C93.4405 161.603 98.3301 157.2 104.191 157.2C107.395 157.2 110.472 158.559 112.633 160.928C114.795 163.297 115.87 166.489 115.582 169.685L114.5 181.733C114.487 181.873 114.371 181.979 114.231 181.979Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M3.03343 136.601L18.3091 100.663L16.0847 99.7148L0.355865 136.718L0.655655 136.736C1.46049 136.782 2.25668 136.731 3.03343 136.601ZM130.561 189.807H91.57V192.229H131.718L131.616 191.946C131.343 191.186 130.985 190.472 130.561 189.807Z" fill="#EFF2F7"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M0.754791 136.47C1.4397 136.504 2.14137 136.466 2.84303 136.357L17.9545 100.806L16.2271 100.069L0.754791 136.47ZM3.078 136.868C2.46384 136.97 1.8486 137.022 1.242 137.022C1.03999 137.022 0.83905 137.017 0.639191 137.005L0.339935 136.988C0.252441 136.983 0.172501 136.935 0.126038 136.861C0.0795898 136.785 0.0725555 136.693 0.107132 136.612L15.836 99.6084C15.8641 99.5424 15.917 99.4904 15.9834 99.4634C16.0499 99.4374 16.1244 99.4379 16.1903 99.4655L18.4141 100.415C18.5519 100.473 18.6156 100.632 18.5573 100.769L3.28165 136.707C3.24545 136.792 3.16875 136.853 3.078 136.868ZM91.8399 191.959H131.333C131.096 191.315 130.786 190.683 130.411 190.078H91.8399V191.959ZM131.717 192.5H91.5698C91.4207 192.5 91.2997 192.379 91.2997 192.229V189.807C91.2997 189.658 91.4207 189.537 91.5698 189.537H130.561C130.653 189.537 130.739 189.584 130.788 189.662C131.236 190.363 131.6 191.101 131.87 191.855L131.971 192.138C132.001 192.221 131.989 192.313 131.938 192.385C131.888 192.457 131.805 192.5 131.717 192.5Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M68.7677 83.5605H111.643L118.294 129.877L122.496 162.865C123.037 167.113 121.607 171.374 118.615 174.431C115.988 177.116 112.393 178.628 108.641 178.628H96.5507C93.5922 178.628 90.7758 177.356 88.8162 175.136C86.5572 172.577 85.7059 169.065 86.5416 165.753L95.1117 131.773L89.2105 107.075L69.8831 135.14C67.5021 138.598 64.1936 141.311 60.3391 142.965C55.5711 145.013 50.2387 145.325 45.2649 143.85L26.2886 138.219C23.1844 137.298 20.7072 134.946 19.6226 131.89C18.7772 129.508 18.8501 126.896 19.8267 124.564L27.5434 106.152C28.1614 104.678 29.3756 103.537 30.8832 103.014C32.69 102.388 34.6913 102.725 36.1941 103.91L53.8042 117.804L68.7677 83.5605Z" fill="#5D242D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M111.41 83.8312L118.027 129.916L122.228 162.9C122.762 167.091 121.375 171.225 118.422 174.242C115.863 176.857 112.298 178.357 108.641 178.357H96.551C93.6714 178.357 90.9258 177.118 89.019 174.957C86.8173 172.463 85.9893 169.047 86.8033 165.819L95.374 131.839C95.3842 131.797 95.3848 131.753 95.3745 131.71L89.4976 107.115L90.9566 104.982C91.0408 104.858 91.0095 104.69 90.8863 104.606C90.7632 104.521 90.5952 104.553 90.5109 104.676L87.1231 109.63C87.1214 109.633 87.1198 109.635 87.1182 109.638L69.6614 134.987C67.3058 138.407 64.0459 141.08 60.233 142.717C55.5336 144.734 50.2449 145.045 45.3419 143.591L26.3656 137.96C23.3548 137.066 20.9289 134.763 19.8773 131.8C19.0524 129.476 19.1232 126.943 20.076 124.669L27.7927 106.257C28.3799 104.856 29.5385 103.767 30.9715 103.27C32.7001 102.671 34.59 102.99 36.0269 104.123L52.7204 117.294C52.7237 117.296 52.7275 117.299 52.7307 117.302L52.7442 117.312L53.6376 118.017C53.6603 118.035 53.6857 118.049 53.7127 118.059L55.0102 119.059C55.0593 119.097 55.1177 119.115 55.1749 119.115C55.2559 119.115 55.3359 119.079 55.3894 119.009C55.4801 118.891 55.458 118.721 55.3397 118.63L54.1421 117.706L68.9446 83.8312H111.41ZM87.5622 109.945L70.1059 135.294C67.6925 138.798 64.3522 141.537 60.4458 143.214C55.6308 145.281 50.212 145.599 45.1885 144.109L26.2122 138.479C23.0361 137.536 20.4779 135.107 19.3684 131.981C18.4982 129.53 18.5728 126.859 19.578 124.46L27.2947 106.047C27.9413 104.505 29.2171 103.306 30.7949 102.759C32.6979 102.099 34.7791 102.45 36.3612 103.698L53.0553 116.869L53.0602 116.873L53.7008 117.367L68.5206 83.4518C68.5638 83.3539 68.6605 83.29 68.768 83.29H111.644C111.778 83.29 111.892 83.3891 111.911 83.5222L118.562 129.842L122.764 162.831C123.319 167.187 121.877 171.485 118.808 174.621C116.147 177.34 112.442 178.899 108.641 178.899H96.551C93.5169 178.899 90.6238 177.592 88.6139 175.315C86.2945 172.687 85.4221 169.088 86.2799 165.686L94.8338 131.771L89.0892 107.728L87.6043 109.884L87.5687 109.936C87.5665 109.939 87.5644 109.942 87.5622 109.945Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M94.9863 45.2722C94.9863 45.2722 93.0773 43.8777 93.4167 38.1187C93.4167 38.1187 90.3975 39.6985 87.1036 37.0273L86.3438 45.2057C86.3438 45.2057 88.6275 48.1059 91.0222 47.8247C93.4167 47.5435 94.9863 45.2722 94.9863 45.2722Z" fill="#D27D41"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M93.3012 37.6528C91.3837 38.6983 89.3827 38.3379 87.2621 36.5458C87.0937 36.4036 86.8558 36.5265 86.8344 36.7668L86.0746 45.2892C86.0669 45.3759 86.0906 45.4624 86.1401 45.5279C87.7156 47.6129 89.3554 48.5695 91.0499 48.3621C92.7213 48.1575 94.1092 47.2263 95.1998 45.5817C95.2956 45.4372 95.2653 45.2288 95.1339 45.1288C93.9675 44.241 93.4651 41.855 93.6857 37.9568C93.6991 37.7188 93.4874 37.5513 93.3012 37.6528ZM86.6247 45.3314L87.3247 37.5676L87.4669 37.6753C89.3803 39.0843 91.2463 39.4153 93.0428 38.6531L93.1222 38.6183L93.1095 38.9403C93.0025 42.2576 93.4758 44.457 94.5671 45.5298L94.6001 45.5605L94.5263 45.6613C93.6088 46.8823 92.4946 47.5921 91.1745 47.7997L90.9932 47.8249C89.4949 48.0061 88.0158 47.1535 86.5464 45.2318L86.6247 45.3314Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M91.092 38.5982C94.7353 38.5982 97.6895 35.4597 97.6895 31.5886C97.6895 27.7175 94.7353 24.5791 91.092 24.5791C87.4481 24.5791 84.494 27.7175 84.494 31.5886C84.494 35.4597 87.4481 38.5982 91.092 38.5982Z" fill="#D27D41"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M97.4223 31.5889C97.4223 35.3063 94.5827 38.3301 91.0922 38.3301C87.6017 38.3301 84.7615 35.3063 84.7615 31.5889C84.7615 27.8715 87.6017 24.8478 91.0922 24.8478C94.5827 24.8478 97.4223 27.8715 97.4223 31.5889ZM97.957 31.5889C97.957 27.576 94.8776 24.3115 91.0922 24.3115C87.3062 24.3115 84.2268 27.576 84.2268 31.5889C84.2268 35.6018 87.3062 38.8663 91.0922 38.8663C94.8776 38.8663 97.957 35.6018 97.957 31.5889ZM92.9735 33.8365L94.0765 33.7023C94.1532 33.6926 94.2229 33.6504 94.2672 33.5854C94.3109 33.5211 94.3244 33.4404 94.3044 33.3647L93.9706 32.0925C93.9333 31.948 93.7837 31.8625 93.6411 31.8993C93.4964 31.9372 93.4105 32.0855 93.4483 32.23L93.7038 33.2023L92.9076 33.2987C92.7601 33.3171 92.6548 33.4518 92.6726 33.6001C92.6888 33.7375 92.8055 33.8381 92.94 33.8381C92.9513 33.8381 92.9621 33.8376 92.9735 33.8365ZM91.8333 31.4359C91.8333 31.7622 91.6669 32.0263 91.4627 32.0263C91.258 32.0263 91.0922 31.7622 91.0922 31.4359C91.0922 31.1096 91.258 30.8456 91.4627 30.8456C91.6669 30.8456 91.8333 31.1096 91.8333 31.4359ZM95.0603 32.0263C95.265 32.0263 95.4308 31.7622 95.4308 31.4359C95.4308 31.1096 95.265 30.8456 95.0603 30.8456C94.8556 30.8456 94.6897 31.1096 94.6897 31.4359C94.6897 31.7622 94.8556 32.0263 95.0603 32.0263ZM91.825 29.6146C91.7766 29.6156 91.2121 29.6272 90.7144 30.0555C90.6631 30.0993 90.6004 30.1209 90.5383 30.1209C90.4621 30.1209 90.3871 30.089 90.3336 30.0268C90.2358 29.9131 90.2493 29.7421 90.3622 29.6453C91.0041 29.0931 91.7253 29.0761 91.8279 29.0738C91.834 29.0736 91.838 29.0735 91.8395 29.0733C91.9886 29.0771 92.1053 29.2005 92.1026 29.3493C92.0999 29.497 91.9789 29.6144 91.832 29.6144H91.8282C91.8286 29.6144 91.8284 29.6145 91.8282 29.6144L91.825 29.6146ZM96.1894 30.0268C96.2872 29.9131 96.2737 29.7421 96.1608 29.6453C95.5232 29.0973 94.8034 29.0769 94.6965 29.0739C94.6892 29.0737 94.6848 29.0736 94.6835 29.0733C94.5338 29.0771 94.4161 29.201 94.4199 29.3504C94.4231 29.4992 94.5527 29.6258 94.6948 29.6144C94.6856 29.6085 95.2938 29.6128 95.8086 30.0555C95.8599 30.0993 95.9226 30.1209 95.9847 30.1209C96.0609 30.1209 96.1359 30.089 96.1894 30.0268ZM94.2678 35.2106C94.3509 35.3345 94.318 35.5028 94.1943 35.5861C93.9383 35.7588 93.4748 35.9492 92.9384 35.9492C92.4944 35.9492 91.9991 35.8183 91.5297 35.439C91.4136 35.3448 91.3957 35.1744 91.4892 35.0586C91.5832 34.9417 91.7533 34.9238 91.8695 35.0174C92.8493 35.8112 93.8508 35.1646 93.894 35.1365C94.0166 35.0548 94.1846 35.0867 94.2678 35.2106Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M90.1241 45.9545C90.5716 45.9545 90.9346 45.4702 90.9346 44.8723C90.9346 44.2743 90.5716 43.79 90.1241 43.79C89.677 43.79 89.3141 44.2743 89.3141 44.8723C89.3141 45.4702 89.677 45.9545 90.1241 45.9545Z" fill="#5D242D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M90.0536 45.4877C90.402 45.4877 90.6856 45.2226 90.6856 44.8968C90.6856 44.5711 90.402 44.3059 90.0536 44.3059C89.7052 44.3059 89.4217 44.5711 89.4217 44.8968C89.4217 45.2226 89.7052 45.4877 90.0536 45.4877ZM86.5343 42.2584C89.7336 45.2735 93.6221 42.8504 93.7859 42.7459C93.8994 42.6734 94.0545 42.6999 94.132 42.8065C94.2102 42.9126 94.1806 43.0576 94.0678 43.1306C94.0435 43.1458 92.6817 43.9953 90.8766 44.1777C91.0658 44.3665 91.1839 44.6182 91.1839 44.8968C91.1839 45.4796 90.6769 45.9536 90.0536 45.9536C89.4303 45.9536 88.9234 45.4796 88.9234 44.8968C88.9234 44.5992 89.0565 44.3308 89.2694 44.1387C88.2503 43.9769 87.1808 43.5289 86.1807 42.5868C86.084 42.4954 86.0846 42.3477 86.1824 42.2573C86.2797 42.1664 86.4377 42.1669 86.5343 42.2584Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M85.2173 35.5693C85.1071 35.4027 85.0029 35.2295 84.9051 35.0488C85.0029 35.2295 85.1066 35.4027 85.2173 35.5693ZM85.9422 36.4524C85.9146 36.4248 85.8887 36.394 85.8612 36.3653C85.8887 36.3934 85.9141 36.4248 85.9422 36.4524ZM89.8589 24.0572C89.8589 24.0572 96.4121 15.0542 102.351 21.482C108.29 27.9104 97.7851 28.0295 97.7851 28.0295L97.2493 27.8991H90.506C89.8535 27.8991 89.3052 28.3888 89.2312 29.0381L88.8915 32.0191C88.542 31.9531 88.1541 31.9953 87.6885 32.5429C87.5162 32.7453 87.3936 33.0023 87.3958 33.2685C87.4006 33.9622 87.9635 34.5228 88.657 34.5228C88.6992 34.5228 88.7386 34.5147 88.7796 34.5104L88.6403 37.6098C88.5447 37.6098 88.455 37.5947 88.3616 37.5871L88.3718 37.6098L89.4414 38.1207C88.6738 43.0421 82.2135 42.6124 82.2135 42.6124C82.2135 42.6124 74.0221 39.8089 77.1619 28.9358C80.3019 18.0633 89.8583 24.0566 89.8589 24.0572Z" fill="#0A4F4D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M85.4384 24.3172C86.6715 20.635 89.8007 24.1067 89.8007 24.1067C89.8007 24.1067 84.2052 28 85.4384 24.3172ZM89.8007 19.7286C93.4132 21.1393 89.8007 24.1029 89.8007 24.1029C89.8007 24.1029 86.1881 18.3174 89.8007 19.7286Z" fill="#5D242D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M82.2667 42.3443C82.8155 42.3697 88.183 42.5061 89.0089 38.2248L88.2527 37.8525C88.2527 37.8525 88.2511 37.852 88.25 37.8514C87.7023 37.7978 87.1832 37.6317 86.7019 37.3596C86.6982 37.3574 86.6944 37.3552 86.6901 37.3531C86.5372 37.2659 86.3876 37.1696 86.2428 37.0614C86.2277 37.05 86.2136 37.0381 86.1991 37.0268C86.0656 36.9245 85.9349 36.8163 85.8091 36.6961C85.7777 36.6669 85.7491 36.6345 85.7189 36.6042C85.6103 36.4954 85.5033 36.3855 85.4012 36.2638C85.3451 36.1972 85.2932 36.1226 85.2387 36.0522C85.1652 35.9554 85.0901 35.8628 85.0199 35.7595C84.8962 35.576 84.7779 35.3823 84.6677 35.1772C83.6857 33.3532 83.5258 31.0794 84.2286 28.9388C84.5499 27.9604 84.9702 26.9708 85.5989 26.1212C85.4979 26.0925 85.4061 26.0509 85.3272 25.9913C84.9324 25.6948 84.8854 25.1191 85.1819 24.2316C85.3834 23.6316 85.6486 23.1786 85.9716 22.8648C84.7147 22.6159 83.2935 22.5742 81.9475 23.0904C79.8457 23.8978 78.323 25.8896 77.4215 29.0113C74.4634 39.2524 81.6277 42.1121 82.2667 42.3443ZM87.1254 33.2704C87.1233 32.9614 87.2502 32.6411 87.483 32.3673C87.9227 31.85 88.3305 31.7266 88.653 31.725L88.9625 29.0075C89.0527 28.2213 89.716 27.6282 90.5057 27.6282H97.2496C97.2712 27.6282 97.2923 27.6309 97.3133 27.6358L97.8146 27.7581C98.2527 27.7472 102.895 27.5855 103.762 25.5644C104.182 24.5877 103.64 23.276 102.153 21.6662C100.7 20.0932 99.0872 19.3416 97.356 19.4477C94.7935 19.5965 92.4967 21.558 91.196 22.9189C90.7088 23.6987 90.019 24.2744 89.9715 24.3134C89.9704 24.3144 89.9688 24.3144 89.9677 24.3155C89.9629 24.3193 89.9602 24.3258 89.9542 24.3296C89.4924 24.651 87.5667 25.9437 86.2525 26.138C85.7426 26.7359 85.371 27.4442 85.0707 28.1947C84.9513 28.494 84.8427 28.7997 84.7417 29.1076C84.0849 31.1081 84.2313 33.2265 85.143 34.9202C85.923 36.3693 87.073 37.2205 88.3818 37.3173L88.3829 37.3179L88.4969 34.7849C87.7326 34.7049 87.1314 34.0561 87.1254 33.2704ZM91.1215 21.2994C91.0351 20.7588 90.5581 20.3156 89.7025 19.9812C89.3568 19.8465 89.0705 19.7778 88.8642 19.7778C88.7173 19.7778 88.6114 19.8124 88.5536 19.8822C88.1647 20.3519 89.057 22.328 89.8619 23.6846C90.3167 23.2506 91.2673 22.2193 91.1215 21.2994ZM89.3795 24.0661C88.9247 23.6321 87.8492 22.7279 86.9407 22.9211C86.4059 23.0331 85.9862 23.532 85.6945 24.4043C85.4925 25.0065 85.4769 25.4275 85.6513 25.5585C86.1386 25.9248 88.0658 24.9367 89.3795 24.0661ZM76.9024 28.8609C77.8536 25.5677 79.486 23.4562 81.7541 22.585C83.4329 21.9406 85.1863 22.0791 86.6447 22.4465C86.7063 22.426 86.7673 22.4043 86.831 22.3908C87.5273 22.2458 88.25 22.5575 88.8302 22.9368C88.229 21.7642 87.5981 20.1901 88.1377 19.5375C88.452 19.1566 89.0284 19.1371 89.8986 19.4769C90.946 19.886 91.5369 20.4709 91.6546 21.2155C91.68 21.3762 91.6779 21.5364 91.6606 21.696C93.0607 20.419 95.0706 19.0391 97.3225 18.9071C99.2228 18.7989 100.98 19.6008 102.549 21.2983C104.195 23.0796 104.77 24.5872 104.259 25.7787C103.214 28.2104 98.009 28.2976 97.7881 28.2997C97.7622 28.2981 97.7428 28.2976 97.7211 28.2921L97.2172 28.1693H90.5057C89.9904 28.1693 89.5577 28.5562 89.4994 29.0686L89.1597 32.0496C89.151 32.1243 89.1121 32.1919 89.0516 32.2368C88.9906 32.2818 88.915 32.2996 88.841 32.285C88.6 32.239 88.3078 32.2314 87.8941 32.7179C87.7455 32.8927 87.6645 33.0875 87.6656 33.2666C87.6694 33.8104 88.1145 34.2525 88.6573 34.2525L88.7535 34.2411C88.8296 34.2341 88.9085 34.2606 88.9652 34.3147C89.0219 34.3683 89.0527 34.4446 89.0495 34.5225L88.9123 37.5744L89.4292 37.8287C89.5351 37.8806 89.595 37.9959 89.5767 38.1133C88.8761 42.6083 83.7403 42.8881 82.4768 42.8881C82.3051 42.8881 82.2051 42.8832 82.1976 42.8827C82.1733 42.8811 82.149 42.8762 82.1263 42.8686C82.0393 42.8388 79.9845 42.1181 78.2998 40.0213C76.7495 38.0917 75.2479 34.5891 76.9024 28.8609Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M78.0319 84.7792H116.14C116.14 84.7792 112.356 71.8364 111.964 66.6065C111.964 66.6065 144.591 61.1186 153.204 24.4453H131C131 24.4453 120.835 50.6519 94.996 44.7705C94.3149 46.2094 92.6247 47.2293 90.6424 47.2293C88.6605 47.2293 86.9704 46.2094 86.2887 44.7705L83.0899 44.9626C78.3538 45.2462 73.6939 46.4074 69.4509 48.5361C62.7557 51.8943 55.1605 58.446 53.8879 71.0518C51.5388 94.3228 67.9828 90.1395 67.9828 90.1395C67.9828 90.1395 73.7252 88.6357 78.0319 84.5179" fill="#5D242D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M78.486 84.5087L88.116 77.0625C88.1748 77.0165 88.2121 76.9488 88.2197 76.8742C88.2267 76.8 88.2029 76.7259 88.1543 76.6702L75.9732 62.7247C75.8792 62.6164 75.7172 62.6013 75.6043 62.6889L70.368 66.7732L70.6451 63.6234C70.6581 63.4746 70.5484 63.3437 70.3999 63.3302C70.2503 63.3166 70.1201 63.427 70.1071 63.5758L69.7852 67.2278L63.4238 72.1892C63.306 72.2812 63.2849 72.4511 63.3762 72.5691C63.468 72.687 63.6376 72.7082 63.7554 72.6162L70.2076 67.5838L70.2124 67.58L75.735 63.2728L87.5585 76.8098L77.867 84.3036C77.8578 84.3112 77.8487 84.3188 77.8406 84.3274C73.6333 88.3468 67.9719 89.863 67.9152 89.8776C67.8606 89.8917 62.2262 91.2656 58.1691 87.7586C54.6932 84.7538 53.3433 79.1414 54.1574 71.0794C55.4375 58.3952 63.2466 51.9506 69.5724 48.7781C73.6803 46.7175 78.2338 45.5243 83.1065 45.2327L86.1282 45.0514C86.9238 46.5449 88.6734 47.4999 90.6428 47.4999C92.5998 47.4999 94.3391 46.5573 95.1423 45.0812C108.498 48.0432 117.593 42.3329 122.879 37.0046C128.105 31.7379 130.731 25.796 131.182 24.7159H152.863C148.387 43.3507 137.553 53.6632 129.228 59.0386C121.103 64.2841 113.73 65.9762 112.206 66.2846C112.166 65.7781 112.109 64.6867 112.232 63.631C112.25 63.4828 112.144 63.3486 111.996 63.3307C111.85 63.3107 111.713 63.4194 111.696 63.5677C111.525 65.0217 111.679 66.4892 111.695 66.6288C112.049 71.3478 115.178 82.4087 115.781 84.5087H78.486ZM68.0497 90.402C67.9438 90.4285 66.7884 90.7125 65.1631 90.712C63.0786 90.712 60.2217 90.2456 57.8207 88.172C54.2 85.0455 52.787 79.2762 53.6199 71.0248C54.9249 58.096 62.8836 51.528 69.3304 48.2943C73.5036 46.2007 78.1279 44.9886 83.0741 44.6927L86.2729 44.5011C86.381 44.4984 86.4858 44.5552 86.5333 44.6553C87.1858 46.033 88.8376 46.9588 90.6428 46.9588C92.448 46.9588 94.0998 46.033 94.7529 44.6553C94.8069 44.5406 94.9344 44.4778 95.0564 44.5071C108.275 47.5162 117.268 41.887 122.483 36.6361C128.154 30.9268 130.723 24.4124 130.748 24.3474C130.789 24.2435 130.889 24.1748 131 24.1748H153.204C153.287 24.1748 153.365 24.2127 153.416 24.2776C153.467 24.342 153.486 24.427 153.467 24.5076C148.998 43.5401 137.967 54.0452 129.501 59.5061C121.211 64.8539 113.688 66.5417 112.253 66.8274C112.732 72.1173 116.362 84.5763 116.4 84.7035C116.423 84.7852 116.408 84.8734 116.356 84.9416C116.306 85.0098 116.226 85.0498 116.14 85.0498H78.0323C77.9832 85.0498 77.9367 85.0368 77.8973 85.0141C73.6284 88.9085 68.108 90.3868 68.0497 90.402Z" fill="black"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M133.183 21.8051L133.368 24.4452H149.747C151.965 23.8586 152.357 21.3711 152.357 21.3711C155.387 22.2234 157.032 18.2138 157.537 16.7003C157.654 16.3496 157.676 15.9746 157.606 15.611C157.466 14.8827 156.966 14.2756 156.278 13.9996L156.076 13.919L156.222 13.2767C156.338 12.7653 156.256 12.2291 155.992 11.7756C155.674 11.2302 155.125 10.8601 154.5 10.7708L154.119 10.7156L154.284 9.47535C154.345 9.01162 154.234 8.54085 153.971 8.1545L153.807 7.91533C153.329 7.21297 152.443 6.91535 151.639 7.18591C151.639 7.18591 152.208 6.27955 152.925 4.12214C153.294 3.01448 152.75 1.99232 152.134 1.26074C151.567 0.587057 150.521 0.614114 149.972 1.30241L143.547 9.21237C143.384 8.92613 143.132 8.76163 142.862 8.67072C142.241 8.46023 141.552 8.66044 141.078 9.11389L136.329 13.6581C134.123 15.7696 132.969 18.7554 133.183 21.8051ZM98.972 59.2581C99.1184 59.2121 99.2556 59.184 99.3852 59.1721L98.972 59.2581ZM101.196 60.6142C101.196 60.6142 100.738 59.0439 99.3852 59.1721L99.4052 59.1678C100.506 58.9394 101.093 57.703 100.541 56.7225C100.518 56.6841 100.505 56.663 100.505 56.663C99.8271 55.4612 98.5507 54.8773 97.3278 55.4103C95.1288 56.3681 91.8165 58.0276 89.778 60.0698C89.778 60.0698 91.2348 57.151 96.006 54.8508C96.9934 54.3746 97.4012 53.1842 96.8816 52.2177L96.8292 52.1203C96.3468 51.2232 95.2503 50.866 94.3321 51.3038C93.5256 51.6885 92.4647 52.287 91.2137 53.2058C89.4615 52.0473 87.0945 52.6458 86.1017 54.4991L84.1663 58.1083L78.4061 65.9198L86.2983 74.9552L88.5124 72.6496C89.6381 71.477 91.0706 70.6464 92.6457 70.2519C93.1259 70.1312 93.6153 70.0528 94.109 70.0165L98.5323 69.6913C99.6305 69.6107 100.48 68.6946 100.48 67.5918C100.48 66.3337 99.3885 65.3635 98.1402 65.4999C97.0226 65.6216 95.5755 65.9225 93.9545 66.6064C93.9545 66.6064 95.5728 64.6303 100.101 63.132C101.147 62.7856 101.667 61.612 101.196 60.6142Z" fill="#D27D41"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M149.711 24.1747H133.619L133.452 21.7857C133.243 18.8074 134.36 15.9163 136.515 13.8541L141.264 9.30983C141.684 8.90833 142.277 8.75736 142.775 8.92673C143.017 9.00865 143.189 9.14003 143.303 9.3292L143.56 9.97421C144.026 11.1419 143.958 12.4493 143.371 13.5618L141.615 16.891L141.611 16.8984L141.609 16.9021L141.607 16.9073L140.698 18.6304C140.628 18.7624 140.679 18.9258 140.811 18.9956C140.851 19.0167 140.894 19.027 140.937 19.027C141.033 19.027 141.127 18.9745 141.176 18.8825L141.72 17.8513C141.735 18.2059 141.711 18.702 141.585 19.3593C141.557 19.5059 141.652 19.6477 141.799 19.6758C141.816 19.6791 141.833 19.6807 141.85 19.6807C141.977 19.6807 142.09 19.5903 142.115 19.461C142.378 18.0848 142.234 17.3363 142.145 17.046L143.849 13.8145C144.509 12.5613 144.587 11.0884 144.062 9.77291L143.857 9.25989L150.181 1.47346C150.397 1.20236 150.717 1.04598 151.061 1.04111C151.406 1.05139 151.713 1.18018 151.927 1.43504C152.692 2.34302 152.941 3.21854 152.669 4.0367C152.036 5.938 151.518 6.85941 151.425 7.01736L146.489 11.9212C146.457 11.9553 144.056 14.5872 145.819 16.7073C146.264 17.1337 147.237 17.7149 148.3 17.5222C148.151 17.8718 148.034 18.3231 148.123 18.7895C148.225 19.3268 148.572 19.7689 149.155 20.1028C149.723 20.428 150.282 20.5075 150.816 20.3392C150.996 20.283 151.161 20.2013 151.311 20.1055C151.291 20.3062 151.3 20.5108 151.357 20.7061C151.459 21.0584 151.691 21.3331 152.046 21.5248C151.902 22.092 151.352 23.7208 149.711 24.1747ZM153.584 8.06744C153.187 7.48504 152.453 7.22487 151.782 7.42427L146.877 12.2973C146.791 12.3909 144.776 14.6073 146.213 16.3377C146.263 16.3853 147.436 17.4744 148.724 16.8115L153.861 10.6033L154.016 9.44024C154.069 9.04144 153.973 8.63885 153.747 8.30661L153.584 8.06744ZM154.229 11.0055L149.114 17.1885L149.109 17.1948C149.103 17.2019 148.513 17.9508 148.653 18.6883C148.724 19.0633 148.984 19.3809 149.423 19.6331C149.855 19.8798 150.268 19.9437 150.652 19.8241C151.12 19.6775 151.471 19.2884 151.678 18.9957C151.798 18.7696 151.905 18.6192 151.919 18.5988L151.92 18.5979C151.925 18.5913 151.93 18.5849 151.935 18.5788L155.827 13.7965L155.959 13.2167C156.06 12.7708 155.988 12.3076 155.759 11.912C155.48 11.4353 155.008 11.1166 154.462 11.0387L154.229 11.0055ZM156.159 14.2441L156.177 14.2513C156.782 14.4931 157.217 15.0207 157.34 15.6619C157.402 15.9834 157.381 16.3129 157.28 16.6148C156.743 18.2236 155.197 21.8812 152.44 21.1134C152.132 20.986 151.948 20.8035 151.876 20.5557C151.762 20.1623 151.945 19.6542 152.132 19.2911C152.256 19.1137 152.334 18.9682 152.367 18.9049L156.159 14.2441ZM133.368 24.7158H149.746C149.769 24.7158 149.793 24.7131 149.815 24.7066C151.739 24.198 152.381 22.4047 152.561 21.6986C155.596 22.3025 157.224 18.4925 157.793 16.7864C157.923 16.3962 157.95 15.972 157.871 15.5602C157.713 14.7415 157.16 14.0673 156.39 13.7534L156.485 13.3368C156.616 12.7562 156.524 12.1539 156.225 11.6393C155.863 11.0187 155.249 10.6042 154.538 10.5024L154.421 10.4862L154.551 9.51112C154.622 8.98029 154.495 8.44459 154.193 8.00196L154.03 7.76279C153.601 7.13348 152.881 6.78501 152.142 6.81964C152.381 6.33534 152.755 5.49013 153.182 4.20824C153.513 3.21259 153.222 2.13307 152.34 1.08656C152.021 0.706704 151.547 0.515692 151.054 0.5C150.548 0.507034 150.076 0.737549 149.76 1.13364L143.552 8.77738C143.391 8.61721 143.189 8.49546 142.948 8.41429C142.25 8.17783 141.462 8.37154 140.891 8.91861L136.142 13.4629C133.87 15.637 132.693 18.6846 132.913 21.8241L133.098 24.4642C133.108 24.606 133.226 24.7158 133.368 24.7158ZM99.6029 66.2293C99.2642 65.9247 98.8234 65.758 98.3702 65.758C98.3033 65.758 98.2363 65.7613 98.1693 65.7688C96.7968 65.9187 95.414 66.2845 94.0592 66.8559C93.9442 66.9041 93.8124 66.8678 93.7378 66.7683C93.6638 66.6687 93.6665 66.5313 93.7454 66.4349C93.8135 66.3521 95.4663 64.3809 100.017 62.875C100.448 62.7321 100.797 62.4123 100.975 61.9973C101.152 61.5855 101.143 61.1353 100.937 60.691C100.935 60.6835 100.693 59.8918 100.089 59.5704C99.8886 59.4638 99.6655 59.42 99.4225 59.4411L99.0271 59.5233C99.0017 59.5287 98.9768 59.5304 98.9525 59.5282C97.2532 59.9254 93.7108 61.0525 91.3271 63.8852C91.2737 63.9485 91.1969 63.9815 91.1202 63.9815C91.0587 63.9815 90.9971 63.9604 90.9463 63.9177C90.8323 63.8214 90.8178 63.6509 90.9139 63.5367C93.8383 60.0617 98.286 59.0688 99.5343 58.8523C99.8983 58.7246 100.192 58.4573 100.355 58.097C100.539 57.6911 100.521 57.2388 100.305 56.8556L100.27 56.7961C99.6272 55.6571 98.488 55.2004 97.4352 55.6587C95.1174 56.6684 91.9407 58.2858 89.9692 60.2609C89.8757 60.355 89.7277 60.3669 89.6202 60.2895C89.5127 60.2116 89.4776 60.0671 89.5365 59.9486C89.5981 59.8263 91.0894 56.9211 95.8887 54.6073C96.3074 54.4055 96.6163 54.0532 96.7584 53.616C96.8961 53.1907 96.8556 52.7394 96.6439 52.346L96.5915 52.2486C96.1777 51.4802 95.2362 51.1724 94.4482 51.5484C93.9993 51.7622 93.5407 52.0095 93.0745 52.2881C93.0005 52.3379 87.9549 55.7523 83.7541 59.1224L78.7523 65.9052L86.3074 74.5554L88.3179 72.4618C89.4798 71.2519 90.9533 70.3969 92.5798 69.9895C93.0718 69.8661 93.5796 69.7844 94.0895 69.7471L98.5128 69.4219C99.4641 69.3515 100.21 68.548 100.21 67.5924C100.21 67.0648 99.9945 66.5805 99.6029 66.2293ZM84.6918 57.6949C86.8967 55.9834 89.1713 54.3498 90.7432 53.2448C90.0356 52.885 89.2146 52.7892 88.4389 52.9856C87.5422 53.2123 86.7768 53.8108 86.3393 54.6268L84.6918 57.6949ZM83.9286 57.9806L83.3641 58.7447C83.3468 58.7631 83.3317 58.7831 83.3204 58.8047L78.1889 65.7591C78.1133 65.8608 78.1192 66.002 78.2029 66.0978L86.0946 75.1333C86.1449 75.1907 86.2162 75.2242 86.2918 75.2258H86.2983C86.3712 75.2258 86.4419 75.1961 86.4927 75.143L88.7074 72.8374C89.7985 71.7 91.1829 70.8975 92.711 70.5144C93.1734 70.3986 93.6503 70.3217 94.1289 70.2866L98.5523 69.9614C99.7844 69.871 100.75 68.8299 100.75 67.5924C100.75 66.9192 100.463 66.2753 99.9637 65.8262C99.4603 65.3744 98.7845 65.1568 98.111 65.231C97.1457 65.3365 96.1767 65.5443 95.2157 65.8511C96.1421 65.1606 97.7312 64.2012 100.186 63.389C100.764 63.1975 101.233 62.7684 101.471 62.2105C101.706 61.6623 101.695 61.0384 101.44 60.4989C101.443 60.4973 101.151 59.5249 100.346 59.0948C100.329 59.0856 100.312 59.0769 100.295 59.0682L100.279 59.0601L100.269 59.0558C100.515 58.8632 100.715 58.6121 100.847 58.3204C101.103 57.7555 101.077 57.1246 100.776 56.59L100.732 56.5164C99.9669 55.1582 98.5193 54.5965 97.2197 55.1625C95.5317 55.8979 93.3932 56.9525 91.5691 58.2382C92.5263 57.2847 93.9879 56.1241 96.1226 55.0949C96.6682 54.8319 97.0868 54.3535 97.2721 53.7827C97.4557 53.2161 97.4017 52.6144 97.1198 52.0895L97.0668 51.9921C96.517 50.9689 95.2643 50.5604 94.2159 51.0598C93.2468 51.5219 92.2335 52.1339 91.2023 52.8801C90.3338 52.3655 89.2891 52.2124 88.3066 52.4607C87.2635 52.7253 86.3728 53.4212 85.8634 54.3714L83.9286 57.9806Z" fill="black"/>
            </svg>
        </Auth-Modal>
    </div>
</template>

<script setup lang="ts">

    import * as yup from 'yup';

    
    const { $resetKYC } = useKYCStore();

    const { fetchApiToken } = useTokenStore();
    
    const { fetchUserProfile } = useUserStore();

    const { formattedPhoneNumberForPayload } = useFormattedPhoneNumberForPayload();
    
    definePageMeta({
        middleware: 'auth',
        auth: {
            unauthenticatedOnly: true,
            navigateAuthenticatedTo: '/dashboard',
        },
    });

    const activeIllustration:Ref<number> = ref(1);

    const illustrations = [
        {
            active: true,
            bodyText: 'Our community codes are unique identifiers created to verify users, ensuring ethical conduct in credit activities, enhancing safety and trust.',
            title: 'What‚Äôs a community code',
            img: '/assets/img/community-code.svg'
        },
        {
            active: false,
            bodyText: 'You can easily request for a community code by simply clicking on the "I don\'t have a community code" link.',
            title: 'I need a community code',
            img: '/assets/img/need-a-communicty-code.svg'
        },
    ];

    function animateIllustration(){
        activeIllustration.value = activeIllustration.value != illustrations.length - 1 ? activeIllustration.value + 1 : 0;
    }

    onMounted(()=>{
        setInterval(() => animateIllustration(), 6000);
    });

    const communityCodeFilled: Ref<boolean> = ref(false);

    const { values: signupFormValues, errors: signupFormErrors, setFieldValue, defineField } = useForm({
        validationSchema: yup.object({
            communityCode: yup.string().required().label('Community Code'),
            firstName: yup.string().required().label('First Name'),
            lastName: yup.string().required().label('Last Name'),
            email: yup.string().email().required().label('Email Address'),
            phoneNumber: yup.string().required().length(11).label('Phone Number'),
            password: yup.string().required()
            .matches(new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[-+_!@#$%^&*.,?]).+$"), 'Password is not in correct format')
            .matches(/^.{8,}$/, 'Password must be a minimum of 8 characters in length').label('Password'),
            phoneVerificationCode: yup.string().required().matches(/^[0-9]+$/, "Phone Verification Code is required")
            .matches(/^.{6}$/, "Phone Verification Code is required").label('Phone Verification Code'),
            emailVerificationCode: yup.string().required().matches(/^[0-9]+$/, "Email Verification Code is required")
            .matches(/^.{6}$/, "Email Verification Code is required").label('Email Verification Code'),
        })
    });
    setFieldValue('password', '');

    const signupForm = {
        email: defineField('email'),
        lastName: defineField('lastName'),
        password: defineField('password'),
        firstName: defineField('firstName'),
        phoneNumber: defineField('phoneNumber'),
        communityCode: defineField('communityCode'),
        phoneVerificationCode: defineField('phoneVerificationCode'),
        emailVerificationCode: defineField('emailVerificationCode')
    };

    const submittingCommunityCode: Ref<boolean> = ref(false);

    const communityCodeErrorResponse: Ref<string> = ref('');

    const communityCodeOwner: Ref<string> = ref('');

    const referrerText = computed(() => {
        return `You have successfully created an account and joined the community through <span class="text-lance-black font-medium">${communityCodeOwner.value}.</span>`;
    })

    const { apiFetch } = useApiFetch();

    async function submitCommunityCode(){

        submittingCommunityCode.value = true;

        const result = await apiFetch(`onboarding/community-code?communityCode=${signupFormValues.communityCode}`);

        if ((result as any).success && !(result as any).error) {
            submittingCommunityCode.value = false;
            communityCodeOwner.value = (result as any).data.firstName;
            communityCodeFilled.value = true;
        } else {
            // console.log((result as any).error);
            submittingCommunityCode.value = false;
            communityCodeErrorResponse.value = (result as any).error;
        }
    }

    const signupFormFilled = computed(()=>{
        return signupFormValues.firstName && !signupFormErrors.value.firstName &&
        signupFormValues.lastName && !signupFormErrors.value.lastName &&
        signupFormValues.email && !signupFormErrors.value.email &&
        signupFormValues.phoneNumber && !signupFormErrors.value.phoneNumber &&
        signupFormValues.password && !signupFormErrors.value.password;
    });

    const signUpSuccess: Ref<boolean> = ref(false);
    
    const submittingSignupForm: Ref<boolean> = ref(false);

    const formattedPhoneNumber = computed(()=>{
        let phoneNumber: string = signupFormValues.phoneNumber;
        if(phoneNumber){
            const first4 = phoneNumber.substring(0,4);
            const last2 = phoneNumber.substring(phoneNumber.length - 2);
            return `${first4}*****${last2}`;
        }
    });

    const signupErrorResponse: Ref<string> = ref('');

    const authToken: Ref<string> = ref('');

    const showResendEmailVerificationCode: Ref<boolean> = ref(false);

    async function submitSignUpForm(){

        submittingSignupForm.value = true;

        const result = await apiFetch(
            'auth/register',
            'POST',
            {
                "source": "web",
                "email": signupFormValues.email,
                "lastName": signupFormValues.lastName,
                "password": signupFormValues.password,
                "firstName": signupFormValues.firstName,
                "communityCode": signupFormValues.communityCode,
                "mobile": formattedPhoneNumberForPayload(signupFormValues.phoneNumber)
            }
        );
    
        if((result as any).success && !(result as any).error){
            signUpSuccess.value = true;
            authToken.value = (result as any).data.token.verification;
            processShowResendEmailVerificationCode();
        } else {
            // console.log((result as any).error);
            signupErrorResponse.value = (result as any).error;
            submittingSignupForm.value = false;
        }
    }

    const emailVerified: Ref<boolean> = ref(false);
    
    const submittingEmailVerificationCode: Ref<boolean> = ref(false);

    const emailVerificationCodeErrorResponse: Ref<string> = ref('');

    const { apiURL } = useRuntimeConfig().public;

    async function submitEmailVerificationCode(){
        
        submittingEmailVerificationCode.value = true;
        
        try {
            const result = await $fetch(`${apiURL}/onboarding/verification`,{
                method: 'POST',
                headers: {
                    "Content-Type": "application/json",
                    "x-verification-token": `Bearer ${authToken.value}`
                },
                body: {
                    "token": signupFormValues.emailVerificationCode,
                    "type": "email"
                }
            });
            
            if((result as any).success && !(result as any).error){
                emailVerified.value = true;
                processShowResendPhoneVerificationCode();
            } else {
                // console.log((result as any).error);
                emailVerificationCodeErrorResponse.value = (result as any).error;
                submittingEmailVerificationCode.value = false;
            }
        } catch (error) {
            // console.log((error as any).response);
            emailVerificationCodeErrorResponse.value = (error as any).response._data.error;
            submittingEmailVerificationCode.value = false;
        }
    }

    async function resendEmailVerificationCode(){
        showResendEmailVerificationCode.value = false;
        
        try {
            await $fetch(`${apiURL}/onboarding/verification?type=email`, {
                method: 'GET',
                headers: {
                    "Content-Type": "application/json",
                    "x-verification-token": `Bearer ${authToken.value}`
                }
            });
        } catch (error) {
            // console.log((error as any).response);
            emailVerificationCodeErrorResponse.value = (error as any).response._data.error;
        }
        
        processShowResendEmailVerificationCode();
    }

    function processShowResendEmailVerificationCode(){
        setTimeout( () => showResendEmailVerificationCode.value = true, 12000);
    }

    const verificationCodeSubmitted: Ref<boolean> = ref(false);

    const submittingPhoneVerificationCode: Ref<boolean> = ref(false);

    const phoneVerificationCodeErrorResponse: Ref<string> = ref('');

    const showResendPhoneVerificationCode: Ref<boolean> = ref(false);

    async function submitPhoneVerificationCode(){

        submittingPhoneVerificationCode.value = true;

        try {
            const result = await $fetch(`${apiURL}/onboarding/verification`, {
                method: 'POST',
                headers: {
                    "Content-Type": "application/json",
                    "x-verification-token": `Bearer ${authToken.value}`
                },
                body: {
                    "token": signupFormValues.phoneVerificationCode,
                    "type": "phone"
                }
            });
    
            if((result as any).success && !(result as any).error){
                // console.log(result);
                verificationCodeSubmitted.value = true;
    
                const { signIn } = useAuth();
            
                const signedIn = await signIn('credentials', { email: signupFormValues.email, password: signupFormValues.password, redirect: false, callbackUrl: '/dashboard' })
    
                if(!(signedIn as any).error){
                    const { resetStores } = useResetStores();
                    resetStores();

                    await fetchApiToken();
                
                    $resetKYC();
    
                    fetchUserProfile();
    
                    navigateTo('/dashboard');
                }
            } else {
                // console.log((result as any).error);
                phoneVerificationCodeErrorResponse.value = (result as any).error;
                submittingPhoneVerificationCode.value = false;
            }
        } catch (error) {
            // console.log((error as any).response);
            phoneVerificationCodeErrorResponse.value = (error as any).response._data.error;
            submittingPhoneVerificationCode.value = false;
        }
    }

    async function resendPhoneVerificationCode(){

        showResendPhoneVerificationCode.value = false;

        try {
            await $fetch(`${apiURL}/onboarding/verification?type=phone`, {
                method: 'GET',
                headers: {
                    "Content-Type": "application/json",
                    "x-verification-token": `Bearer ${authToken.value}`
                }
            });
        } catch (error) {
            // console.log((error as any).response);
            phoneVerificationCodeErrorResponse.value = (error as any).response._data.error;
        }

        processShowResendPhoneVerificationCode();
    }

    function processShowResendPhoneVerificationCode(){
        setTimeout( () => showResendPhoneVerificationCode.value = true, 12000);
    }
</script>
